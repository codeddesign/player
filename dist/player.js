!function(){"use strict";function e(e){return new g(e)}function t(e){var t=document.createElement("a");t.href=e;var i=t.protocol+"//"+t.host,n=""+i+t.pathname,s=""+n+t.search+t.hash,a=v(s);return{virtual:t,link:{base:i+"/",simple:n,complete:s,file_name:a}}}function i(){return new $}function n(){return new w}function s(e){var t,i,n=new Audio,s=!1;return n.src=e.src,n.preload="metadata",n.isPlaying=!1,n.isMuted=!0,n.addEventListener("canplaythrough",function(){s||(s=!0,n.play())}),t=n.play,n.play=function(){return s?!(!s||n.isPlaying)&&(n.isPlaying=!0,n.currentTime=e.currentTime,void t.apply(this,arguments)):(n.load(),!1)},i=n.pause,n.pause=function(){return!!n.isPlaying&&(n.isPlaying=!1,e.currentTime=n.currentTime,void i.apply(this,arguments))},n}function a(e){function t(){return!r.isPaused&&!r.hasFinished&&(r.currentTime>=r.duration?(r.hasFinished=!0,e._$el.pub("animator:completed"),!1):(u.isPlaying||requestAnimationFrame(t),a=r.currentTime+i/1e3,o=r.readyState>=r.HAVE_FUTURE_DATA,void(r.currentTime<=a&&o&&(r.currentTime=a))))}var i=30,n=e._$el.find("video",!1);if(!n)return!1;var a,o,r=n.node,u=!1;return r.hasFinished=!1,r.isPaused=!0,r.addEventListener("canplaythrough",function(){u||(u=new s(r))}),r.addEventListener("timeupdate",function(){!u.isPlaying||r.isPaused||r.hasFinished||(requestAnimationFrame(t),u.currentTime-r.currentTime>.1&&(r.currentTime=u.currentTime))}),r.play=function(e){return!(!r.isPaused&&!e)&&(r.isPaused=!1,t(),void(u.isPlaying||u.isMuted||"undefined"==typeof u.play||u.play()))},r.pause=function(){return!r.isPaused&&(r.isPaused=!0,void(u.isPlaying&&!u.isMuted&&u.pause()))},r.stop=function(){r.hasFinished=!0,r.currentTime=r.duration},r.unmute=function(){return!(r.hasFinished||!u.isMuted)&&(u.isMuted=!1,void(r.isPaused||u.play()))},r.mute=function(){return!r.hasFinished&&!u.isMuted&&(u.isMuted=!0,u.pause(),void(r.isPaused||r.play(!0)))},r}function o(e,t){return new S(e,t)._yt}function r(){return Math.random().toString().replace(".","")}function u(t){var i="a"+r(),n='<div style="max-width:640px;max-height: 379px;position:relative;margin: 0px auto;" class="hidden" id="'+i+'">\n        <div class="player__aclose hidden">CLOSE <img src="'+b.path+'css/images/closeicon.png"></div>\n        <div class="player__container hidden">\n            <div class="player__overlay" '+(t.isStandard()?'style="background-image: url(http://img.youtube.com/vi/'+t.videos().url+'/hqdefault.jpg);"':"")+'>\n                <span class="player__playmain icon-play hidden"></span>\n            </div>\n            <div class="player__loading hidden">\n              <div class="sk-cube sk-cube1"></div>\n              <div class="sk-cube sk-cube2"></div>\n              <div class="sk-cube sk-cube3"></div>\n              <div class="sk-cube sk-cube4"></div>\n              <div class="sk-cube sk-cube5"></div>\n              <div class="sk-cube sk-cube6"></div>\n              <div class="sk-cube sk-cube7"></div>\n              <div class="sk-cube sk-cube8"></div>\n              <div class="sk-cube sk-cube9"></div>\n            </div>\n            <div class="player__youtube hidden"></div>\n\n            <div class="player__controls hovering hidden">\n                <progress class="player__progress" min="0" max="0" value="0"></progress>\n                <div class="left">\n                    <span class="player__play icon-play"></span>\n                    <span class="time__container">\n                        <span class="player__timelive">00:00</span> / <span class="player__timetotal">00:00</span>\n                    </span>\n                </div>\n                <div class="right">\n                    <span class="player__volume icon-volume2-hold"></span>\n                    <span class="player__full icon-fullscreen-hold"></span>\n                </div>\n            </div>\n            <a href="http://a3m.io" target="_blank" class="player__logo hovering"></a>\n            <div class="player__share hovering hidden">\n                <span class="icon-vidshareurl"></span>\n                <span class="icon-vidfacebook"></span>\n                <span class="icon-vidtwitter"></span>\n            </div>\n            <div class="player__code hidden">\n                <span class="close">&#x2715;</span>\n                <span>Add this code to your website</span>\n                <textarea rows="2">'+b.script.htmlSelf()+'</textarea>\n            </div>\n            <span class="player__asound icon-mute hidden"></span>\n        </div>\n    </div>';b.script.replace(n);var s=e().findId(i),a={};return s.findAll('*[class*="player__"]').forEach(function(e){var t=e.classesStr().match(/player__(\w+)(\s|$)/);t&&(a[t[1]]=e)}),{$el:s,$els:a}}function l(t){var i=function(){return!!t.mainTag.ima.loaded&&(!t.mainTag.ima.started&&t.$el.onScreen().mustPlay?(t.$els.container.removeClass("onscroll"),!1):!t.mainTag.ima.completed&&t.$el.onScreen().mustPlay?(!t.campaign.isStandard()||!E.isIPhone())&&(t.mainTag.ima.manager.resume(),!1):void 0)},n=function(){if(!t.mainTag.ima.completed&&t.$el.onScreen().mustPause)return t.mainTag.ima.manager.pause(),!1};e().sub("touchend",function(){return!!t.mainTag&&(t.mainTag.ima.initialized?void t.loadNextTag(!0):(t.mainTag.ima.initialize(!0),!1))}),e().sub("scroll",function(){return!!t.mainTag&&(i(),void n())}),t.$el.sub("loaded",function(){t.$els.loading.hide(),E.isMobile()||t.$el.pub("canplay")}),t.$el.sub("completed",function(){t.youtubePlay()}),t.$el.sub("aerror",function(){E.isMobile()||t.loadNextTag()})}function d(e){var t=Math.floor(e/60);return e=Math.floor(e%60),t=t<=9?"0"+t:t,e=e<=9?"0"+e:e,[t,e].join(":")}function c(e){var t=function(){return!e._youtubeReady||!e._youtube.isPlaying()},i=function(){return!e._youtubeReady||e._youtube.isPlaying()},n=function(e,t){return e.layerX*t.max/t.offsetWidth},s=function(t){e.$els.progress.attr("value",t),e.$els.timelive.html(d(t))},a=function(){e.$els.play.addClass("icon-pause"),e.$els.play.removeClass("icon-play")},o=function(){e.$els.play.addClass("icon-play"),e.$els.play.removeClass("icon-pause")},r=!1;e.$els.overlay.sub("click",function(t,n){return!i()&&(!!e.tagsReady()&&(r=!0,n.hide(),e.$els.logo.hide(),e.$els.overlay.hide(),void e.play()))}),e.$els.play.sub("click",function(){return e._youtube.isPlaying()?(e._youtube.pauseVideo(),!1):void e._youtube.play()}),e.$els.progress.sub("click",function(t,i){t.preventDefault(),t.stopPropagation(),e.$el.pub("yt:jump",{seconds:n(t,i.node)})}),e.$els.container.sub("hovering",function(t){e.$hovering.forEach(function(e){return e.hasClass("hidden")||"show"==t.detail.action?(e.removeClass("hidden"),!1):void e.addClass("hidden")})}),e.$els.container.sub("hovering:show",function(e,t){t.pub("hovering",{action:"show"})}),e.$els.container.sub("hovering:hide",function(e,t){t.pub("hovering",{action:"hide"})}),e.$els.container.sub("mouseover",function(e,i){return!t()&&void i.pub("hovering:show")}),e.$els.container.sub("mouseout",function(e,i){return!t()&&void i.pub("hovering:hide")}),e.$els.share.find(".icon-vidshareurl").sub("click",function(){e._youtube.pauseVideo(),e.$els.code.show()}),e.$els.code.find(".close").sub("click",function(t){e.$els.code.hide(),e._youtube.resume()}),e.$els.code.find("textarea").sub("click",function(e,t){t.select()}),e.$els.share.find(".icon-vidfacebook").sub("click",function(){e._youtube.pauseVideo(),FB.ui({method:"share",mobile_iframe:!0,href:location.href},function(t){e._youtube.resume()})}),e.$els.share.find(".icon-vidtwitter").sub("click",function(){e._youtube.pauseVideo(),window.open("https://twitter.com/share?url="+escape(location.href)+"&text=Watch this!","","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600")}),e.$el.sub("yt:ready",function(){e.onYoutubeReady(),e.$els.youtube=e.$el.find("iframe.player__youtube"),setInterval(function(){e.$el.pub("yt:timeupdate")},1e3);var t=e._youtube.getDuration()-1;e.$els.progress.attr("max",t),e.$els.timetotal.html(d(t)),e.$els.timelive.html(d(0))}),e.$el.sub("yt:timeupdate",function(){return!t()&&void s(e._youtube.getCurrentTime())}),e.$el.sub("yt:jump",function(t){e._youtube.seekTo(t.detail.seconds),s(t.detail.seconds)}),e.$el.sub("yt:playing",function(){e.$els.container.pub("hovering:show"),e.$els.logo.hide(),e.$els.overlay.hide(),e.$els.youtube.show(),a()}),e.$el.sub("yt:paused",function(){e.$els.container.pub("hovering:show"),o()}),e.$el.sub("yt:ended",function(){e.$els.container.pub("hovering:show"),o()}),e.$el.sub("aerror",function(){e.noTagsLeft()||(e.$els.container.addClass("aderror"),e.$els.loading.hide(),e.$els.youtube.show()),r&&e.play()})}function h(e){e.$els.aclose.sub("click",function(t,i){i.hide(),e.mainTag.ima.manager.stop()}),e.$els.asound.sub("click",function(t,i){t.stopPropagation();var n=i.hasClass("icon-mute")?1:0;return i.pub("toggle:sound",{sound:!!n}),E.isIPhone()?void(n?e.mainTag.ima.animator.unmute():e.mainTag.ima.animator.mute()):(e.mainTag.ima.manager.setVolume(n),!1)}),e.$els.asound.sub("toggle:sound",function(e,t){return e.detail.sound?(t.addClass("icon-volume1"),t.removeClass("icon-mute"),!1):(t.addClass("icon-mute"),void t.removeClass("icon-volume1"))}),e.$el.sub("hovering:sound",function(t){return!E.isIPhone()&&void e.mainTag.ima.manager.setVolume(t.detail.volume)}),e.$el.sub("mouseover",function(e,t){t.pub("hovering:sound",{volume:1})}),e.$el.sub("mouseout",function(e,t){t.pub("hovering:sound",{volume:0})}),e.$el.sub("canplay",function(){if(!e.mainTag.ima.started&&e.$el.onScreen().mustPlay)return e.$els.container.removeClass("onscroll"),!1}),e.$els.container.sub("transitionend",function(){e.play()}),e.$el.sub("started",function(){e.$els.aclose.show(),E.isMobile()&&e.$els.asound.show()}),e.$el.sub("completed",function(){e.$els.container.addClass("onscroll"),e.$els.aclose.hide()})}function p(e,t){t=t||m.priority_rules;var i,n=Object.keys(t),s=n.map(function(e){return t[e]}).sort(),a=s[s.length-1],o=[],r=[];return e.forEach(function(e){i=!1,n.some(function(n){return!!e.contains(n)&&(i=t[n],!0)}),i===!1&&(i=a),o[i]||(o[i]=[]),o[i].push(e)}),o.forEach(function(e){r.push.apply(r,e)}),r}function y(e){return new C(e)}var m={app_path:"http://videoapp.dev",fb_appId:0xf87f5b1aced8,priority_rules:{teads:0,googletest:0,tubemogul:1,aol:2,adap:2,beachfront:3,tremor:4}};!function(){window.fbAsyncInit=function(){FB.init({appId:m.fb_appId,xfbml:!0,version:"v2.6"})},function(e,t,i){var n,s=e.getElementsByTagName(t)[0];e.getElementById(i)||(n=e.createElement(t),n.id=i,n.src="//connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(n,s))}(document,"script","facebook-jssdk")}();var f=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={});var n=document.createElement(e);return Object.keys(t).forEach(function(e){return n[e]=t[e]}),Object.keys(i).forEach(function(e){n[e]=i[e].apply(n)}),n},g=function(e){return this.node=e||document,this};g.prototype.find=function(e,t){void 0===t&&(t=!0);var i=this.node.querySelector(e);return i?new g(i):(t&&console.warn("Failed to find: "+e),!1)},g.prototype.findId=function(e,t){return void 0===t&&(t=!1),this.find("#"+e)},g.prototype.findAll=function(e){var t,i=this.node.querySelectorAll(e),n=[];for(t=0;t<i.length;t++)n.push(new g(i[t]));return n},g.prototype.data=function(){return this.node.dataset},g.prototype.html=function(e){return void 0===e&&(e=!1),e?(this.node.innerHTML=e.trim(),this):this.node.innerHTML},g.prototype.htmlSelf=function(){return this.node.outerHTML.trim()},g.prototype.css=function(e,t){return this.node.style[e]=t,this},g.prototype.show=function(){return this.removeClass("hidden"),this},g.prototype.hide=function(){return this.addClass("hidden"),this},g.prototype.hasClass=function(e){return this.classes().contains(e)},g.prototype.addClass=function(e){return this.hasClass(e)||this.classes().add(e),this},g.prototype.removeClass=function(e){return this.hasClass(e)&&this.classes().remove(e),this},g.prototype.classes=function(){return this.node.classList},g.prototype.classesStr=function(){return this.classes().toString()},g.prototype.toggleClasses=function(e,t){var i;return this.hasClass(e)&&(i=e,e=t,t=i),this.addClass(e),this.removeClass(t),this},g.prototype.attr=function(e,t){return void 0===t&&(t=!1),t?this.node.setAttribute(e,t):this.node.getAttribute(e)},g.prototype.replace=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),this.parent().node.replaceChild(t.firstChild,this.node),this},g.prototype.remove=function(){return this.parent().node.removeChild(this.node),this},g.prototype.parent=function(){return new g(this.node.parentNode)},g.prototype.style=function(e,t){return this.node.style[e]=t,this},g.prototype.addChild=function(e,t,i){var n=f(e,t,i);return this.node.appendChild(n),new g(n)},g.prototype.addBefore=function(e,t){void 0===t&&(t={});var i=f(e,t,events);return this.parent().node.insertBefore(i,this.node.nextSibling),new g(i)},g.prototype.select=function(){return this.node.select(),this},g.prototype.onScreen=function(){var e=this.node.getBoundingClientRect(),t=(e.height||360)/2,i=Math.abs(e.top),n=window.innerHeight-i,s=e.top<window.innerHeight&&e.bottom>0,a=n>=t,o=e.top<0&&i>=t||n<=t||!1,r=s&&a&&!o;return{mustPlay:r,mustPause:o,bounds:e}},g.prototype.sub=function(e,t){var i=this;this.node.addEventListener(e,function(e){t.call(i,e,i)})},g.prototype.pub=function(e,t){void 0===t&&(t={});var i=new CustomEvent(e,{detail:t});this.node.dispatchEvent(i)};var v=function(e){var t=e.split("/").pop();return t.includes(".")?t:""},_=function(i){var n=t(i.src).link,s=n.file_name.match(/\d+/g);if(!s.length)throw new Error("Failed to parse source id.");this.id=s[0],this.path=n.simple.replace(n.file_name,""),this.script=e(i)},b=function(){return new _(document.currentScript)}(),$=function(){var t=this;this.head=e().find("head"),this._list=[{name:"youtube",tag:"script",attributes:{src:"https://www.youtube.com/iframe_api"}},{name:"ima",tag:"script",attributes:{src:"//imasdk.googleapis.com/js/sdkloader/ima3.js"},events:{oncomplete:function(){var e=setInterval(function(){t._googleIsReady()&&(clearInterval(e),t.imaReady())},1)}}},{name:"css",tag:"link",attributes:{rel:"stylesheet",href:b.path+"css/style.css"}},{name:"glyph",tag:"link",attributes:{rel:"stylesheet",href:b.path+"css/glyphter-font/css/adzicons.css"}}],this.asset=null};$.prototype.add=function(e){var t=this;this.imaReady=e,this._list.forEach(function(e){t.asset=e,t.__addOne()})},$.prototype._googleIsReady=function(){return"undefined"!=typeof google},$.prototype.__addOne=function(){var t=this.asset,i=t.attributes.href?"href":"src",n=t.tag+"["+i+'="'+t.attributes[i]+'"]',s=e().find(n,!1);if(!s)return this.head.addChild(t.tag,t.attributes,t.events),this;if("ima"==t.name){if(!this._googleIsReady())throw new Error("Google is already added but it it's not loaded");return this.imaReady(),this}};var w=function(){var e=this,t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];return this.xhr=!1,"undefined"!=typeof XMLHttpRequest?void(this.xhr=new XMLHttpRequest):void t.some(function(t){try{return e.xhr=new ActiveXObject(t),!0}catch(e){return!1}})};w.prototype.get=function(e,t){var i=this;void 0===t&&(t=function(){}),this.xhr.onreadystatechange=function(){if(4===i.xhr.readyState){var e=i.xhr.responseText;try{e=JSON.parse(i.xhr.responseText)}catch(e){console.warn("Failed to parse JSON")}t(e,200==i.xhr.status,i.xhr.status)}},this.xhr.open("GET",e,!0),this.xhr.send()},w.prototype.campaign=function(e,t){this.get(m.app_path+"/campaign/"+e,t)};var T=function(){this.agent=navigator.userAgent,this.platform=navigator.platform};T.prototype.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(this.agent)},T.prototype.isIGadget=function(){return/webOS|iPhone|iPad|iPod/i.test(this.agent)},T.prototype.isIPhone=function(){var e=/iPhone|iPod/i.test(this.agent),t=/iPhone|iPod/i.test(this.platform);return e&&t};var E=function(){return new T}(),k=function(e){this.data=e};k.prototype.isStandard=function(){return"standard"==this.data.info.type},k.prototype.isOnscroll=function(){return"onscrolldisplay"==this.data.info.type},k.prototype.tags=function e(){var e;switch(this.data.info.type){case"standard":e=this.data.tags.general;break;case"onscrolldisplay":e=this.data.tags.stream;break;default:console.warn("Unhandled campaign type",this.data.info.type)}return E.isMobile()?e.mobile:e.desktop},k.prototype.size=function(){return this.isOnscroll()?{width:640,height:360}:this._parseSize()},k.prototype.videos=function e(){var e=this.data.campaign.videos;return!this.isOnscroll()&&(this.isStandard()?e[0]:e)},k.prototype._parseSize=function(){var e;return"auto"!=this.data.campaign.size&&(e=this.data.campaign.size.split("x"),{width:e[0],height:e[1]})};var P=function(e){this._tag=e,this._player=e._player,this._$el=!1,this._$video=!1,this.error=!1,this.display=!1,this.loader=!1,this.request=!1,this.manager=!1,this.initialized=!1,this.loaded=!1,this.played=!1,this.completed=!1,this.animator=!1,this._setSelector()._setDisplay()._setRequest()._makeRequest()};P.prototype._setSelector=function(){return this._$el=this._player.$els.container.addChild("div",{className:"player__video ad hidden"}),this},P.prototype._setDisplay=function(){return this.display=new google.ima.AdDisplayContainer(this._$el.node,null),this},P.prototype._setRequest=function(){return this.request=new google.ima.AdsRequest,this.request.adTagUrl=this._tag.link,this.request.linearAdSlotWidth=this._player.size().width,this.request.linearAdSlotHeight=this._player.size().height,this.request.nonLinearAdSlotWidth=this._player.size().width,this.request.nonLinearAdSlotHeight=this._player.size().height,this},P.prototype._makeRequest=function(){var e=this;return this.loader=new google.ima.AdsLoader(this.display),this.loader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.loader.getSettings().setNumRedirects(10),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){e._setManager(t),e._player.onManagerLoad(e._tag)},!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(t){console.error("Manager",e.error=t.getError()),e._player.onManagerLoad(),e._$el.remove()},!1),this.loader.requestAds(this.request),this},P.prototype._setManager=function(e){var t=this,i=new google.ima.AdsRenderingSettings;i.restoreCustomPlaybackStateOnAdBreakComplete=!0,i.loadVideoTimeout=3e3,i.enablePreloading=!0,this.manager=e.getAdsManager(this._player.$els.youtube,i),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._aError.bind(this)),Object.keys(google.ima.AdEvent.Type).forEach(function(e){return"DURATION_CHANGE"!=e&&("CONTENT_RESUME_REQUESTED"!=e&&void t.manager.addEventListener(google.ima.AdEvent.Type[e],t._aEvent.bind(t)))})},P.prototype.initialize=function(e){return void 0===e&&(e=!1),this._player.$els.loading.show(),this._$el.show(),this.initialized||E.isMobile()&&!e||(this.initialized=!0,this.display.initialize(),this.manager.init(this._player.size().width,this._player.size().height,google.ima.ViewMode.NORMAL),this._player.campaign.isOnscroll()&&this.manager.setVolume(0)),this},P.prototype.play=function(){return this.initialize(!0),this.started?(this.completed||this.manager.resume(),this):(this.manager.start(),this)},P.prototype._aError=function(e){console.error(this.error=e.getError()),this._$el.remove(),this._player.$el.pub("aerror")},P.prototype._aEvent=function(e){var t=this;switch(console.log(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.loaded=!0,this._player.$el.pub("loaded"),E.isIPhone()&&this._player.campaign.isOnscroll()&&(this._$el.sub("animator:completed",function(){t.manager.stop()}),this.animator=new a(this));break;case google.ima.AdEvent.Type.STARTED:this.started=!0,this._player.$el.pub("started");break;case google.ima.AdEvent.Type.AD_CAN_PLAY:this._player.$el.pub("canplay");break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.completed=!0,this._$el.hide(),this._player.$el.pub("completed");break;case google.ima.AdEvent.Type.VOLUME_CHANGED:this._player.$els.asound.pub("toggle:sound",{sound:1});break;case google.ima.AdEvent.Type.VOLUME_MUTED:this._player.$els.asound.pub("toggle:sound",{sound:0})}};var A=function(e,t){this.link=e,this.ima=!1,this._player=t,this._setLink()};A.prototype.request=function(){return this.ima=new P(this),this},A.prototype.contains=function(e){if(void 0===e&&(e=!1),!e)throw Error("Tag's match string can\t be empty");return this.link.toLowerCase().indexOf(e.toLowerCase())!==-1},A.prototype._setLink=function(){var e=this,i=t(location.href),n={"[width]":this._player.size().width,"[height]":this._player.size().height,"[timestamp]":Date.now(),"[referrer_root]":encodeURIComponent(i.link.base),"[referrer_url]":encodeURIComponent(i.link.complete),"[user_agent]":E.agent,"[ip_address]":""};return Object.keys(n).forEach(function(t){e.link=e.link.replace(t,n[t])}),this};var S=function(e,t){var i=this;this._status=!1,this._muted=!1,this._isFullscreen=!1,this._yt=new YT.Player(e.$els.youtube.node,{videoId:t,playerVars:{enablejsapi:1,disablekb:1,controls:0,showinfo:0,modestbranding:1,rel:0,autoplay:0,iv_load_policy:3,fs:0},events:{onReady:function(){i._yt.hasEnded=function(){return 0==i._status},i._yt.isPlaying=function(){return 1==i._status},i._yt.isPaused=function(){return 2==i._status},i._yt.wasPlayed=function(){return i._yt.isPlaying()||i._yt.isPaused()},i._yt.play=function(){e.campaign.isStandard()&&i._yt.playVideo()},i._yt.resume=function(){i._yt.hasEnded()||i._yt.playVideo()},e.$el.pub("yt:ready")},onStateChange:function(t){var n={0:"ended",1:"playing",2:"paused",3:"loading"};i._status=t.data,e.$el.pub("yt:"+n[t.data])}}})},C=function(e){this.campaign=new k(e),this.$el=!1,this.$els=[],this.$hovering=!1,this.mainTag=!1,this._tags=[],this._tagsRequested=0,this._tagsLoaded=0,this._youtube=!1,this._youtubeReady=!1,this.__setTemplateElements().__setTemplateListeners().__setView().__setTags().__setYoutube()};C.prototype.play=function(){return this.mainTag.ima.loaded&&!this.mainTag.ima.error?(this.mainTag.ima.play(),this):(this.youtubePlay(),this)},C.prototype.youtubePlay=function(){return this._youtube?(this.$els.youtube.show(),E.isMobile()||this._youtube.play(),this):this},C.prototype.onManagerLoad=function(e){this._tagsRequested++,e&&this._tags.push(e),this.tagsReady()&&(console.info("All tags requested"),this._tags=p(this._tags),this.loadNextTag(),this.campaign.isStandard()&&this.$els.playmain.show())},C.prototype.onYoutubeReady=function(){this._youtubeReady=!0},C.prototype.tagsReady=function(){return this._tagsRequested>=this.campaign.tags().length},C.prototype.size=function(){if(this.campaign.isStandard())return{width:this.$el.node.offsetWidth,height:this.$el.node.offsetHeight};if(!this.campaign.size())throw Error("Failed to determine size");return this.campaign.size()},C.prototype.loadNextTag=function(e){var t=this;if(void 0===e&&(e=!1),this.mainTag&&this.mainTag.ima.initialized&&this.mainTag.ima.loaded&&!this.mainTag.ima.error)return!1;var i=[];this._tags.some(function(n,s){return n.ima.error?(i.push(s),!1):!!(t._youtube&&t._youtubeReady&&t._youtube.wasPlayed())||(t.mainTag=n,t.mainTag.ima.initialize(e),!0)}),i.forEach(function(e){t._tags.splice(e,1)})},C.prototype.noTagsLeft=function(){return!this._tags.length},C.prototype.__setTemplateElements=function(){var e=u(this.campaign);return this.$el=e.$el,this.$els=e.$els,this.$hovering=e.$el.findAll(".hovering"),this},C.prototype.__setTemplateListeners=function(){return l(this),this.campaign.isStandard()&&c(this),this.campaign.isOnscroll()&&h(this),this},C.prototype.__setView=function(e){return E.isMobile()&&(this.$els.container.addClass("mobile"),E.isIGadget()&&this.$els.container.addClass("iDevice")),this.campaign.isStandard(),this.$el.show(),this.$els.container.show(),this.campaign.isOnscroll()&&(this.$els.logo.hide(),this.$els.overlay.hide(),this.$els.container.addClass("onscroll")),this},C.prototype.__setTags=function(){var e=this;return this.campaign.tags().forEach(function(t,i){var n=new A(t,e);n.request()}),this},C.prototype.__setYoutube=function(){var e=this,t=function(){return"undefined"!=typeof YT&&"undefined"!=typeof YT.Player};if(this.campaign.isStandard())var i=setInterval(function(){t()&&(clearInterval(i),e._youtube=o(e,e.campaign.videos().url))},1);return this},i().add(function(){n().campaign(b.id,function(e,t,i){if(!t)throw new Error("Campaign "+b.id+" does not exist.");new y(e)})})}();